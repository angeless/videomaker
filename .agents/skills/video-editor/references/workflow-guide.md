# VideoEditer 工作流指南

## 第一阶段：策划审核

### 输入
- 脚本和叙事脉络（来自另一 session）

### 输出
1. **视频大纲**
   - 分段结构
   - 每段时长
   - 叙事节奏（快/慢/转折）

2. **剪辑思路**
   - 转场风格
   - 色调方向
   - 节奏把控

3. **候选素材清单**
   - 按段落分类
   - 每个镜头的备选方案
   - 素材可用性评估

### 确认节点
⚠️ **必须等待用户确认后才能进入下一阶段**

---

## 第二阶段：素材管理

### 素材接收方式
- 百度云链接
- Google Drive 链接
- 直接发送文件

### 素材处理
1. 调用「视频素材整理 skill」进行：
   - 分类（按地点/时间/场景）
   - 标注（内容标签、质量评分）
   - 语义索引（支持内容描述搜索）

2. 根据脚本语义搜索匹配素材

---

## 第三阶段：剪辑执行

### 3.1 生成剪映草稿

使用脚本生成 JSON：

```bash
python scripts/generate_jianying_json.py \
    --script script.json \
    --materials materials_index.json \
    --output draft.json \
    --width 1080 --height 1920
```

### 3.2 添加双语字幕

- 根据脚本中的字幕配置生成
- 中文主字幕 + 英文副字幕
- 样式：白色字体、黑色描边、底部居中

### 3.3 配置 BGM

根据情绪标签匹配音乐：

| 场景类型 | 推荐情绪 | BPM 范围 |
|---------|---------|---------|
| 开场/转场 | 欢快/史诗 | 120-140 |
| 风景展示 | 史诗/抒情 | 80-100 |
| 人文/美食 | 温馨 | 90-110 |
| 探险/运动 | 紧张/欢快 | 130-150 |

### 3.4 旁白配音

**优先级：**
1. 用户提供的录音文件
2. AI 克隆声音合成

---

## 第四阶段：画面优化

### 4.1 磨皮处理
- 检测人脸出镜片段
- 智能磨皮（保留质感）

### 4.2 调色优化
- 统一色调风格
- 提升视觉质感

---

## 第五阶段：脚本反推

### 触发条件
- 素材不足
- 素材与脚本不匹配
- 时长不够

### 处理流程
1. 识别问题
2. 提出调整建议（替代素材/脚本修改）
3. **等待用户确认**
4. 执行调整

---

## 效率优化原则

| 任务类型 | 处理方式 | 原因 |
|---------|---------|------|
| 视频渲染 | 本地 | 减少 token，速度快 |
| 音频处理 | 本地 | 减少 token，速度快 |
| 素材选择 | AI 辅助 | 需要语义理解 |
| 节奏决策 | AI 辅助 | 需要创意判断 |

---

## 常见问题处理

### Q: 素材路径不识别？
A: 确保使用绝对路径，且文件存在。

### Q: 剪映导入失败？
A: 检查：
1. JSON 格式是否正确
2. 所有 ID 是否为有效 UUID
3. 时间单位是否为微秒

### Q: 字幕显示异常？
A: 检查字符编码（需 UTF-8），避免特殊字符。
